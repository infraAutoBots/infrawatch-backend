
🚀 Iniciando testes de autenticação...

🔑 Testando login via JSON...
Status: 200
✅ Login JSON bem-sucedido. Token: eyJhbGciOiJIUzI1NiIs...

📝 Testando login via formulário...
Status: 200
✅ Login formulário bem-sucedido. Token: eyJhbGciOiJIUzI1NiIs...

🔄 Testando refresh token...
Status: 200
✅ Refresh token bem-sucedido. Novo token: eyJhbGciOiJIUzI1NiIs...

📋 RELATÓRIO FINAL
Login JSON           ✅
Login Formulário     ✅
Refresh Token        ✅
🧪 Testador da API de Usuários - InfraWatch
--------------------------------------------------
🚀 Iniciando testes da API de Usuários...
🔗 API Base: http://localhost:8000
✅ Autenticação realizada com sucesso

🔍 Testando listagem de usuários...
Status: 200
✅ Listagem básica funcionando
   Total de usuários: 3
   Página atual: 1
   Total de páginas: 1
✅ Paginação funcionando
✅ Busca funcionando
✅ Filtros funcionando

➕ Testando criação de usuário...
Status: 201
✅ Usuário criado com sucesso
   ID: 6
   Nome: Usuário Teste

👤 Testando obtenção do usuário 6...
Status: 200
✅ Usuário obtido com sucesso
   Nome: Usuário Teste
   Email: teste_20250908_134345@exemplo.com

✏️ Testando atualização do usuário 6...
Status: 200
✅ Usuário atualizado com sucesso
   Novo nome: Usuário Teste Atualizado

🔄 Testando alteração de status do usuário 6...
Status (desativar): 200
✅ Status alterado para inativo
✅ Status alterado para ativo

🗑️ Testando exclusão do usuário 6...
Status: 200
✅ Usuário excluído com sucesso

📊 Testando obtenção de estatísticas...
Status: 200
✅ Estatísticas obtidas com sucesso
   Total de usuários: 3
   Administradores: 3
   Monitores: 0
   Visualizadores: 0

==================================================
📋 RELATÓRIO FINAL DOS TESTES
==================================================
Listagem             ✅ PASSOU
Criação              ✅ PASSOU
Obter usuário        ✅ PASSOU
Atualizar usuário    ✅ PASSOU
Alterar status       ✅ PASSOU
Excluir usuário      ✅ PASSOU
Estatísticas         ✅ PASSOU

📈 Resumo: 7/7 testes passaram (100.0%)
🎉 Todos os testes passaram com sucesso
🚀 Testando API de Usuários - InfraWatch
========================================
�🔍 Verificando se a API está rodando...
✅ API está rodando
🔐 Fazendo login...
❌ Falha no login
Resposta: {"detail":"Credenciais inválidas"}
🧪 Testador da API de Configuração - InfraWatch
------------------------------------------------------------
🚀 Iniciando testes da API de Configuração...
🔗 API Base: http://localhost:8000
✅ Autenticação realizada com sucesso

============================================================
🔗 EXECUTANDO TESTES DE WEBHOOK
============================================================

🔍 Testando listagem de webhooks...
Status: 200
✅ Listagem funcionando
   Webhooks encontrados: 1
   ID: 1, URL: https://discord.com/api/webhooks/1412595075099136141/WP7CfeZ4saW39XoaDb17WrgLwhNw49r3_ufGg-wOj6dTWYmSE4A019AXLyRLtRCp5jjX, Ativo: True

➕ Testando criação de webhook...
Status: 200
✅ Webhook criado com sucesso
   ID: 2
   URL: https://hooks.slack.com/services/TEST/20250908_134346

🔗 Testando obtenção do webhook 2...
Status: 200
✅ Webhook obtido com sucesso
   URL: https://hooks.slack.com/services/TEST/20250908_134346
   Ativo: True

✏️ Testando atualização do webhook 2...
Status: 200
✅ Webhook atualizado com sucesso
   Nova URL: https://hooks.slack.com/services/UPDATED/WEBHOOK/URL
   Ativo: False

🗑️ Testando exclusão do webhook 2...
Status: 200
✅ Webhook excluído com sucesso

============================================================
📧 EXECUTANDO TESTES DE EMAIL
============================================================

📧 Testando listagem de configurações de email...
Status: 200
✅ Listagem funcionando
   Configurações encontradas: 1
   ID: 1, Email: ndondadaniel2020@gmail.com, Servidor: smtp.gmail.com

➕ Testando criação de configuração de email...
Status: 500
❌ Falha na criação: {"detail":"Error creating email config: 'EmailConfigSchema' object has no attribute 'active'"}

============================================================
⚠️ EXECUTANDO TESTES DE LIMITES DE FALHAS
============================================================

⚠️ Testando listagem de configurações de limites...
Status: 200
✅ Listagem funcionando
   Configurações encontradas: 1
   ID: 1, SNMP: 10, Ping: 5

➕ Testando criação de configuração de limites de falhas...
Status: 200
✅ Configuração de limites criada com sucesso
   ID: 2
   Falhas SNMP: 3
   Falhas Ping: 5

✏️ Testando atualização da configuração de limites 2...
Status: 200
✅ Configuração de limites atualizada com sucesso
   Novas falhas SNMP: 5
   Novas falhas Ping: 3

🗑️ Testando exclusão da configuração de limites 2...
Status: 200
✅ Configuração de limites excluída com sucesso

============================================================
🔍 EXECUTANDO TESTE DE CONFIGURAÇÕES ATIVAS
============================================================

🔍 Testando obtenção de configurações ativas...
Status: 200
✅ Configurações ativas obtidas com sucesso
   Webhook ativo: Sim
   Email ativo: Sim
   Limites ativos: Sim

============================================================
📋 RELATÓRIO FINAL DOS TESTES
============================================================
Listar Webhooks           ✅ PASSOU
Criar Webhook             ✅ PASSOU
Obter Webhook             ✅ PASSOU
Atualizar Webhook         ✅ PASSOU
Excluir Webhook           ✅ PASSOU
Listar Emails             ✅ PASSOU
Criar Email               ❌ FALHOU
Listar Limites            ✅ PASSOU
Criar Limites             ✅ PASSOU
Atualizar Limites         ✅ PASSOU
Excluir Limites           ✅ PASSOU
Configurações Ativas      ✅ PASSOU

📈 Resumo: 11/12 testes passaram (91.7%)
⚠️ Alguns testes falharam. Verifique a implementação.
🚀 Iniciando testes das rotas de alertas...
============================================================
🔐 Fazendo autenticação...
✅ Autenticação bem-sucedida. Token: eyJhbGciOiJIUzI1NiIs...

📝 Testando criação de alerta...
Status: 200
❌ Falha na criação do alerta: {"title":"Teste de Alerta - 20250908_134346","description":"Este é um alerta de teste criado automaticamente","severity":"medium","category":"infrastructure","system":"test-system-001","impact":"low","assignee":"admin","id_endpoint":1,"id":226,"status":"active","created_at":"2025-09-08T13:43:46.511848","updated_at":"2025-09-08T13:43:46.511848","acknowledged_at":null,"resolved_at":null,"duration":"0min"}
----------------------------------------

📋 Testando listagem de alertas...
Status (sem parâmetros): 200
✅ Listagem básica bem-sucedida!
   Total de alertas: 226
   Página atual: 1
   Alertas retornados: 10
   Primeiro alerta - ID: 226, Título: Teste de Alerta - 20250908_134346
Status (com parâmetros): 200
✅ Listagem com parâmetros bem-sucedida!
   Total: 226
   Páginas: 46
----------------------------------------

🔍 Testando detalhes de alerta...
⚠️  Nenhum alerta criado para testar. Usando ID 1...
Status: 500
❌ Falha ao obter detalhes: Internal Server Error
----------------------------------------

✏️ Testando atualização de alerta...
⚠️  Nenhum alerta criado para testar atualização
----------------------------------------

🔍 Testando filtros de alertas...
❌ Erro no teste 'Filtros de Alertas': ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
----------------------------------------

❌ Testando casos de erro...
Status (alerta inexistente): 404
✅ Erro 404 para alerta inexistente funcionando corretamente
Status (dados inválidos): 422
✅ Validação de dados inválidos funcionando corretamente
----------------------------------------

📊 RELATÓRIO FINAL DOS TESTES
============================================================
Criação de Alerta: ❌ FALHOU
Listagem de Alertas: ✅ PASSOU
Detalhes do Alerta: ❌ FALHOU
Atualização de Alerta: ❌ FALHOU
Filtros de Alertas: ❌ FALHOU
Casos de Erro: ✅ PASSOU
------------------------------------------------------------
Total: 6 | Passou: 2 | Falhou: 4
⚠️  4 teste(s) falharam

🚀 Iniciando testes de monitoramento...

🔐 Autenticando para testes de monitor...
✅ Autenticado. Token: eyJhbGciOiJIUzI1NiIs...

➕ Testando adição de endpoint...
Status: 422
❌ Falha ao adicionar endpoint: {"detail":[{"type":"missing","loc":["body","nickname"],"msg":"Field required","input":{"ip":"192.168.56.123","interval":30,"version":"2c","community":"public","port":161,"user":"","authKey":"","privKey":"","sysDescr":"desc","sysName":"name","sysUpTime":"up","hrProcessorLoad":"1","memTotalReal":"1","memAvailReal":"1","hrStorageSize":"1","hrStorageUsed":"1","hrStorageDescr":"1"}},{"type":"missing","loc":["body","ifOperStatus"],"msg":"Field required","input":{"ip":"192.168.56.123","interval":30,"version":"2c","community":"public","port":161,"user":"","authKey":"","privKey":"","sysDescr":"desc","sysName":"name","sysUpTime":"up","hrProcessorLoad":"1","memTotalReal":"1","memAvailReal":"1","hrStorageSize":"1","hrStorageUsed":"1","hrStorageDescr":"1"}},{"type":"missing","loc":["body","ifInOctets"],"msg":"Field required","input":{"ip":"192.168.56.123","interval":30,"version":"2c","community":"public","port":161,"user":"","authKey":"","privKey":"","sysDescr":"desc","sysName":"name","sysUpTime":"up","hrProcessorLoad":"1","memTotalReal":"1","memAvailReal":"1","hrStorageSize":"1","hrStorageUsed":"1","hrStorageDescr":"1"}},{"type":"missing","loc":["body","ifOutOctets"],"msg":"Field required","input":{"ip":"192.168.56.123","interval":30,"version":"2c","community":"public","port":161,"user":"","authKey":"","privKey":"","sysDescr":"desc","sysName":"name","sysUpTime":"up","hrProcessorLoad":"1","memTotalReal":"1","memAvailReal":"1","hrStorageSize":"1","hrStorageUsed":"1","hrStorageDescr":"1"}}]}

📊 Testando obtenção de status dos endpoints...
Status: 200
✅ Status dos endpoints obtido com sucesso
{'monitors': [{'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 1,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:55.033719',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '0.309',
                        'snmp_rtt': '60265.18426500115',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.1',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 2,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:55.036333',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '0.224',
                        'snmp_rtt': '60244.23030500475',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.2',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 3,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:55.038793',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '0.086',
                        'snmp_rtt': '60218.521248993056',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.3',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 5,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:06.827423',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': None,
                        'snmp_rtt': None,
                        'status': False,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '192.168.8.146',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 6,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:55.067345',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '0.082',
                        'snmp_rtt': '60237.24432500603',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.4',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 7,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:41:55.275429',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '284.6284910046961',
                        'snmp_rtt': '0.0',
                        'status': False,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.5',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 8,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:41:55.290710',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '129.778',
                        'snmp_rtt': '0.0',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '8.8.8.8',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 9,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:41:55.496236',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '225.42193299887003',
                        'snmp_rtt': '0.0',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': 'dgg.gg',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 10,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:55.098383',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '0.251',
                        'snmp_rtt': '60074.00550600141',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.11',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 11,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:55.127539',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '0.144',
                        'snmp_rtt': '60076.28712100268',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.12',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 12,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:41:55.275438',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '209.3596409977181',
                        'snmp_rtt': '0.0',
                        'status': False,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '127.0.0.13',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 13,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:06.809837',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '11568.681866003317',
                        'snmp_rtt': '0.0',
                        'status': False,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '192.168.0.3',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 14,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:41:55.290582',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '34.378875003312714',
                        'snmp_rtt': '0.0',
                        'status': True,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '1.1.1.1',
               'snmp': True},
              {'data': {'active': False,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 15,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T12:57:55.956447',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '11791.118794993963',
                        'snmp_rtt': '0.0',
                        'status': False,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '2.1.1.1',
               'snmp': True},
              {'data': {'active': True,
                        'hrProcessorLoad': None,
                        'hrStorageDescr': None,
                        'hrStorageSize': None,
                        'hrStorageUsed': None,
                        'id_end_point': 16,
                        'ifInOctets': None,
                        'ifOperStatus': None,
                        'ifOutOctets': None,
                        'last_updated': '2025-09-08T13:42:06.793146',
                        'memAvailReal': None,
                        'memTotalReal': None,
                        'ping_rtt': '11804.670757999702',
                        'snmp_rtt': '0.0',
                        'status': False,
                        'sysDescr': None,
                        'sysName': None,
                        'sysUpTime': None},
               'endpoint': '3.1.1.1',
               'snmp': True}],
 'total': 15,
 'total_depravado': 9,
 'total_offline': 6,
 'total_online': 9}

🔍 Testando obtenção de info de endpoint...
Status: 404
❌ Falha ao obter info do endpoint: {"detail":"IP/Domínio não encontrado"}

📋 RELATÓRIO FINAL
Adicionar endpoint        ❌
Obter status endpoints    ✅
Obter info endpoint       ❌
✅ API está rodando em http://localhost:8000
🧪 Iniciando testes das rotas de SLA...
==================================================
✅ Autenticação realizada com sucesso

🔍 Executando: SLA Summary

📊 Testando endpoint de resumo SLA...
Status (30 dias): 200
✅ Resumo SLA obtido com sucesso
   - Endpoints encontrados: 0
   - Métricas SLA: 0
   - Incidentes: 0
   - Dados de performance: 0
   - Alertas: 0
Status (7 dias): 200
✅ Resumo para 7 dias obtido com sucesso
Status (15 dias): 200
✅ Resumo para 15 dias obtido com sucesso
Status (60 dias): 200
✅ Resumo para 60 dias obtido com sucesso
Status (90 dias): 200
✅ Resumo para 90 dias obtido com sucesso
✅ SLA Summary - PASSOU

🔍 Executando: SLA Endpoint Specific

🎯 Testando endpoint específico por endpoint...
Status (endpoint 1): 200
✅ SLA do endpoint 1 obtido com sucesso
   - Chaves disponíveis: ['status', 'data']
Status (endpoint 2): 200
Status (endpoint 3): 200
✅ SLA Endpoint Specific - PASSOU

🔍 Executando: SLA Incidents Summary

� Testando resumo de incidentes...
Status: 200
✅ Resumo de incidentes obtido com sucesso
   - Chaves disponíveis: ['status', 'data']
Status (filtro {'days': 7}): 200
Status (filtro {'days': 30}): 200
Status (filtro {'endpoint_id': 1}): 200
✅ SLA Incidents Summary - PASSOU

🔍 Executando: SLA Performance Metrics

📈 Testando métricas de performance...
Status: 200
✅ Métricas de performance obtidas com sucesso
   - Chaves disponíveis: ['status', 'data']
Status (filtro {'endpoint_id': 1}): 200
Status (filtro {'days': 7}): 200
Status (filtro {'days': 30}): 200
✅ SLA Performance Metrics - PASSOU

🔍 Executando: SLA Compliance

✅ Testando endpoint de compliance...
Status: 200
✅ Compliance SLA obtido com sucesso
   - Estrutura dos dados: <class 'dict'>
Status (target 99.0%): 200
Status (target 99.5%): 200
Status (target 99.9%): 200
Status (target 99.95%): 200
✅ SLA Compliance - PASSOU

==================================================
📊 RESUMO DOS TESTES DE SLA:
   Total: 5
   Passou: 5
   Falhou: 0
   Taxa de sucesso: 100.0%
==================================================
